<!doctype html>

<html>

<head>

<title>(mt) Account Center - evanyoung.info : Site monitoring</title>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.4.0/Chart.bundle.js"></script>
<script>
 	
$( document ).ready(function() {
 var data = { //info used to style and plot the graph 
   labels: [],
    datasets: [
      {
        label: "CSS Loading Time",
        fillColor: "#000",
        strokeColor: "rgba(255, 173, 86, 1)",
        pointColor: "rgba(255, 173, 86, 1)",
        pointStrokeColor: "#fff",
        pointHighlightFill: "#fff",
        pointHighlightStroke: "rgba(220,220,220,1)",
        data: []
      },
      
   
      {
        label: "HTML Loading Time",
        fillColor: "rgba(255, 173, 86,0.2)",
        strokeColor: "rgba(255, 173, 86,1)",
        pointColor: "rgba(151,187,205,1)",
        pointStrokeColor: "#fff",
        pointHighlightFill: "#fff",
        pointHighlightStroke: "rgba(151,187,205,1)",
        data: []
      }
    ]
  };

	$.get( "http://205.186.162.214:5000/tests/", function( newdata ) {
		apidata = newdata; //Adds point data to datasets
		
		
		
		for (var i = 0; i < apidata.data.length; i++) {

		data.datasets[0].data.push(apidata['data'][i]['pages'][0]['css_load_time']);
		data.datasets[1].data.push(apidata['data'][i]['pages'][0]['html_load_time']);
		
		timeAverage ();
		myGraph (apidata);
	}
		function myGraph (harData) {  //Adds the site name
		var graphPlace = document.getElementById("monitr");
		var graphData = harData['data'][0]['hostname'];
		graphPlace.innerHTML = "This report is for: " + graphData;
		
			}

		function timeAverage () { //Gets the CSS and HTML time average
		var csstime = data.datasets[0].data;
		var total = 0;
		for(var i = 0; i < csstime.length; i++) {
		total += csstime[i];
}
		var cssavg = total / csstime.length;
		var cssavgtext = document.getElementById("cssaverage");
		cssavgtext.innerHTML = "Average CSS loading time: " + cssavg + " seconds";

		var htmltime = data.datasets[1].data;
		var total = 0;
		for(var i = 0; i < htmltime.length; i++) {
		total += htmltime[i];
}
		var htmlavg = total / htmltime.length;
		var htmlavgtext = document.getElementById("htmlaverage");
		htmlavgtext.innerHTML = "Average HTML loading time: " + htmlavg + " seconds";
		
	for (var i = 0; i < apidata.data.length; i++) {
		data.labels[i] = apidata.data[i].startedDateTime;
}
		  // Get the context of the canvas element we want to select
  var ctx = document.getElementById("myChart").getContext("2d");

  // Instantiate a new chart using 'data' (defined below)
//  var myChart = new Chart(ctx).Line(data);
var myNewChart = new Chart(ctx , {
    type: "line",
    data: data, 
});




}

});

});




	

</script>

<style>
.text-items {

	text-align: right;
	color:#888888;
}
</style>
</head>
<body>
	<div id= "container">
		<canvas id="myChart" width="740" height="200"></canvas>
		<div id="monitr" class="text-items"></div>
		<div id="cssaverage" class="text-items"></div>
		<div id="htmlaverage" class="text-items"></div>
		<div id="result"></div>

	</div>



</body>
</html>